function Update-Hostsfile {
  Clear-Host
  Write-Host "Updating hosts file... (Breaks Microsoft Store Installs and some Microsoft sites)" -ForegroundColor Cyan
  Start-Sleep -Seconds 3
  
  
  $hostsFile = "$env:windir\System32\drivers\etc\hosts"
  
$hostEntries = @"
127.0.0.1 activity.windows.com
127.0.0.1 tile-service.weather.microsoft.com
127.0.0.1 evoke-windowsservices-tas.msedge.net
127.0.0.1 cdn.onenote.net
#127.0.0.1  spclient.wg.spotify.com
127.0.0.1 ctldl.windowsupdate.com
127.0.0.1 www.bing.com
127.0.0.1 fp.msedge.net
127.0.0.1 k-ring.msedge.net
127.0.0.1 b-ring.msedge.net
127.0.0.1 www.bing.com
#127.0.0.1  login.live.com
127.0.0.1 cs.dds.microsoft.com
127.0.0.1 dmd.metaservices.microsoft.com
127.0.0.1 v10.events.data.microsoft.com
127.0.0.1 watson.telemetry.microsoft.com
127.0.0.1 fs.microsoft.com
127.0.0.1 licensing.mp.microsoft.com
127.0.0.1 inference.location.live.net
127.0.0.1 maps.windows.com
127.0.0.1 ssl.ak.dynamic.tiles.virtualearth.net
127.0.0.1 ssl.ak.tiles.virtualearth.net
127.0.0.1 dev.virtualearth.net
127.0.0.1 ecn.dev.virtualearth.net
127.0.0.1 ssl.bing.com
#127.0.0.1  login.live.com
127.0.0.1 edge.activity.windows.com
127.0.0.1 edge.microsoft.com
127.0.0.1 msedge.api.cdp.microsoft.com
#127.0.0.1 go.microsoft.com/fwlink
#127.0.0.1 go.microsoft.com
127.0.0.1 img-prod-cms-rt-microsoft-com.akamaized.net
127.0.0.1 wns.windows.com
127.0.0.1 storecatalogrevocation.storequality.microsoft.com
127.0.0.1 displaycatalog.mp.microsoft.com
127.0.0.1 storesdk.dsx.mp.microsoft.com
127.0.0.1 pti.store.microsoft.com
127.0.0.1 manage.devcenter.microsoft.com
127.0.0.1 store-images.s-microsoft.com
127.0.0.1 www.msftconnecttest.com
127.0.0.1 outlook.office365.com
127.0.0.1 office.com
127.0.0.1 blobs.officehome.msocdn.com
127.0.0.1 officehomeblobs.blob.core.windows.net
127.0.0.1 blob.core.windows.net
127.0.0.1 self.events.data.microsoft.com
127.0.0.1 outlookmobile-office365-tas.msedge.net
127.0.0.1 roaming.officeapps.live.com
127.0.0.1 substrate.office.com
127.0.0.1 g.live.com
127.0.0.1 oneclient.sfx.ms
127.0.0.1 logincdn.msauth.net
127.0.0.1 windows.policies.live.net
127.0.0.1 api.onedrive.com
127.0.0.1 skydrivesync.policies.live.net
127.0.0.1 storage.live.com
127.0.0.1 settings.live.net
127.0.0.1 settings.data.microsoft.com
127.0.0.1 settings-win.data.microsoft.com
127.0.0.1 pipe.aria.microsoft.com
127.0.0.1 config.edge.skype.com
127.0.0.1 config.teams.microsoft.com
127.0.0.1 wdcp.microsoft.com
127.0.0.1 smartscreen-prod.microsoft.com
127.0.0.1 definitionupdates.microsoft.com
127.0.0.1 smartscreen.microsoft.com
127.0.0.1 checkappexec.microsoft.com
127.0.0.1 arc.msn.com
127.0.0.1 ris.api.iris.microsoft.com
127.0.0.1 mucp.api.account.microsoft.com
127.0.0.1 prod.do.dsp.mp.microsoft.com
127.0.0.1 emdl.ws.microsoft.com
127.0.0.1 dl.delivery.mp.microsoft.com
127.0.0.1 windowsupdate.com
127.0.0.1 delivery.mp.microsoft.com
127.0.0.1 update.microsoft.com
127.0.0.1 adl.windows.com
127.0.0.1 tsfe.trafficshaping.dsp.mp.microsoft.com
127.0.0.1 dlassets-ssl.xboxlive.com
127.0.0.1 da.xboxservices.com
127.0.0.1 www.xboxab.com
0.0.0.0     accounts.firefox.com
0.0.0.0     accounts-static.cdn.mozilla.net
0.0.0.0     activations.cdn.mozilla.net
0.0.0.0     api.accounts.firefox.com
0.0.0.0     autopush.prod.mozaws.net
0.0.0.0     blocklist.addons.mozilla.org
0.0.0.0     blocklists.settings.services.mozilla.com
0.0.0.0     classify-client.services.mozilla.com
0.0.0.0     code.cdn.mozilla.net
0.0.0.0     color.firefox.com
0.0.0.0     content.cdn.mozilla.net
0.0.0.0     content-signature-2.cdn.mozilla.net
0.0.0.0     content-signature.cdn.mozilla.net
0.0.0.0     coverage.mozilla.org
0.0.0.0     crash-reports.mozilla.com
0.0.0.0     crash-stats.mozilla.com
0.0.0.0     discovery.addons.mozilla.org
0.0.0.0     experiments.mozilla.org
0.0.0.0     fastestfirefox.com
0.0.0.0     fhr.cdn.mozilla.net
0.0.0.0     firefox.settings.services.mozilla.com
0.0.0.0     firefoxusercontent.com
0.0.0.0     getpocket.cdn.mozilla.net
0.0.0.0     img-getpocket.cdn.mozilla.net
0.0.0.0     incoming.telemetry.mozilla.org
0.0.0.0     input.mozilla.org
0.0.0.0     install.mozilla.org
0.0.0.0     location.services.mozilla.com
0.0.0.0     mitmdetection.services.mozilla.com
0.0.0.0     normandy.cdn.mozilla.net
0.0.0.0     normandy-cloudfront.cdn.mozilla.net
0.0.0.0     oauth.accounts.firefox.com
0.0.0.0     onyx_tiles.stage.mozaws.net
0.0.0.0     ostats.mozilla.com
0.0.0.0     outgoing.prod.mozaws.net
0.0.0.0     profile.accounts.firefox.com
0.0.0.0     profiler.firefox.com
0.0.0.0     push.services.mozilla.com
0.0.0.0     qsurvey.mozilla.com
0.0.0.0     search.services.mozilla.com
0.0.0.0     self-repair.mozilla.org
0.0.0.0     sentry.prod.mozaws.net
0.0.0.0     shavar.services.mozilla.com
0.0.0.0     snippets.cdn.mozilla.net
0.0.0.0     sync.services.mozilla.com
0.0.0.0     telemetry-coverage.mozilla.org
0.0.0.0     telemetry-experiment.cdn.mozilla.net
0.0.0.0     telemetry.mozilla.org
0.0.0.0     testpilot.firefox.com
0.0.0.0     tiles-cloudfront.cdn.mozilla.net
0.0.0.0     tiles.services.mozilla.com
0.0.0.0     token.services.mozilla.com
0.0.0.0     token.services.mozilla.org
0.0.0.0     tracking-protection.cdn.mozilla.net
0.0.0.0     start.thunderbird.net
0.0.0.0     live.mozillamessaging.com
0.0.0.0     live.thunderbird.net
0.0.0.0     broker-live.mozillamessaging.com
0.0.0.0     v10.events.data.microsoft.com
0.0.0.0     v10c.events.data.microsoft.com
0.0.0.0     v10.vortex-win.data.microsoft.com
0.0.0.0     watson.telemetry.microsoft.com
0.0.0.0     umwatsonc.events.data.microsoft.com
0.0.0.0     ceuswatcab01.blob.core.windows.net
0.0.0.0     ceuswatcab02.blob.core.windows.net
0.0.0.0     eaus2watcab01.blob.core.windows.net
0.0.0.0     eaus2watcab02.blob.core.windows.net
0.0.0.0     weus2watcab01.blob.core.windows.net
0.0.0.0     weus2watcab02.blob.core.windows.net
0.0.0.0     oca.telemetry.microsoft.com
0.0.0.0     oca.microsoft.com
0.0.0.0     kmwatsonc.events.data.microsoft.com
0.0.0.0     au.vortex-win.data.microsoft.com
0.0.0.0     au-v10.events.data.microsoft.com
0.0.0.0     au-v20.events.data.microsoft.com
0.0.0.0     eu-v10.events.data.microsoft.com
0.0.0.0     eu-v20.events.data.microsoft.com
0.0.0.0     in-v10.events.data.microsoft.com
0.0.0.0     in-v20.events.data.microsoft.com
0.0.0.0     jp-v10.events.data.microsoft.com
0.0.0.0     jp-v20.events.data.microsoft.com
0.0.0.0     uk.vortex-win.data.microsoft.com
0.0.0.0     uk-v20.events.data.microsoft.com
0.0.0.0     us4-v20.events.data.microsoft.com
0.0.0.0     us5-v20.events.data.microsoft.com
0.0.0.0     us-v10.events.data.microsoft.com
0.0.0.0     us-v20.events.data.microsoft.com
0.0.0.0     v20.events.data.microsoft.com
0.0.0.0     synapse3ui-common.razerzone.com
0.0.0.0     bespoke-analytics.razerapi.com
0.0.0.0     discovery.razerapi.com
0.0.0.0     manifest.razerapi.com
0.0.0.0     cdn.razersynapse.com
0.0.0.0     assets.razerzone.com
0.0.0.0     assets2.razerzone.com
0.0.0.0     deals-assets-cdn.razerzone.com
0.0.0.0     synapse-3-webservice.razerzone.com
0.0.0.0     albedozero.razerapi.com
0.0.0.0     gms.razersynapse.com
0.0.0.0     fs.razersynapse.com
0.0.0.0     id.razer.com
0.0.0.0     liveupdate01s.asus.com
0.0.0.0     asusactivateservice.azurewebsites.net
0.0.0.0     rog-live-service.asus.com
0.0.0.0     dlcdn-rogboxbu1.asus.com
0.0.0.0     dlcdn-rogboxbu2.asus.com
0.0.0.0     mymessage.asus.com
0.0.0.0     gaming-config.asus.com
0.0.0.0     rog-content-platform.asus.com
0.0.0.0     nomos.asus.com
0.0.0.0     dlcdnrog.asus.com
0.0.0.0     account.asus.com
"@
  
  Copy-Item $hostsFile "$hostsFile.bak" -Force
  Add-Content -Path $hostsFile -Value "`n$hostEntries" -Force
  
  Clear-Host
  Write-Host "Hosts file updated successfully." -ForegroundColor Green
  Start-Sleep -Seconds 3
}
